<!doctype html>
<html lang="en">
<head>
    <title>FEATSKY Best-1.0</title>
    <meta charset="UTF-8">
    <meta name="keywords" content="featsky,featsky博客,641151096"/>
    <meta name="description" content="featsky的个人博客,641151096的个人博客"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <link rel="stylesheet" href="src/css/base.css">
    <link rel="stylesheet" href="src/css/movie.css">
</head>
<body>

    <header>
        <!--<img id="logo" src="img/logo.png" alt="">-->
        <ul class="nav-list fx-col-b">
            <li></li>
            <li></li>
            <li></li>
        </ul>
        <h4 class="titles">影视</h4>
    </header>

    <div class="container">

        <ul id="movie-item">
            <!--<li class="movie-list">
                &lt;!&ndash;<img src="img/0.jpg" alt="">&ndash;&gt;
                <div class="movie-content"></div>
                <div class="movie-mask">
                    &lt;!&ndash;<ul class="summary fx-row-b">
                        <li class="detail ml15">
                            <p class="detail-text">在那屋反倒是发送到发送到发送到发送到</p>
                        </li>
                        <li class="mr15 fr10">02-15</li>
                    </ul>&ndash;&gt;
                    <div class="summary fx-row-b">
                        <p class="detail-text">在那屋反倒是发送到发送到发送到发送到第三方士大夫</p>
                        <span class="mr15 fr10">02-15</span>
                    </div>
                </div>
                <div class="movie-box">
                    <h5 class="box-text">关于火力控制</h5>
                </div>
            </li>-->
        </ul>

    </div>


    <!--列表模板-->
    <div id="model-1" class="hide">
        <li class="movie-list">
            <div data-name="imgPath" class="movie-content"></div>
            <div class="movie-mask">
                <div class="summary fx-row-b">
                    <p data-name="description" class="detail-text"></p>
                    <span data-name="time" class="mr15 fr10"></span>
                </div>
            </div>
            <div class="movie-box">
                <h5 data-name="title" class="box-text"></h5>
            </div>
        </li>
    </div>


    <script src="src/lib/zepto.js"></script>
    <script src="src/js/common.js"></script>
    <script src="src/js/ajax.js"></script>

    <script>
    $(function(){

        var pageResult = 0,pageCount = 2;

        renderData();

        function renderData(){

            app.ajax('get',app.url('getMovieList.php'),{page:pageCount,pageStart:pageResult},function(data){

                var obj = data,str = '';

                console.log(obj);

                var model = $('#model-1').clone();

                for(var i=0;i<obj.length;i++){

                    if(obj[i].statusCode == 404){continue;}

                    //列表id
                    model.find('.movie-list').attr('data-id',obj[i].id);

                    //列表背景
                    model.find("[data-name='imgPath']").css('background-image',"url(img/"+obj[i].imgPath+")");

                    //标题
                    model.find("[data-name='title']").text(obj[i].title);

                    //时间
                    model.find("[data-name='time']").text(obj[i].time);

                    //介绍
                    model.find("[data-name='description']").text(obj[i].description);

                    str +=  model.html();
                }

                if(str == ''){

                    alert('没了')

                }else{

                    $('#movie-item').append(str);

                }

                return pageResult = pageResult + pageCount;
            })

        }



    })
    </script>

</body>
</html>